</script>
async function buildDashboard() {
    const container = document.getElementById("dashboard");
  
    try {
      const res = await fetch("characters.json");
  
      // Check if the fetch is successful
      if (!res.ok) {
        throw new Error("Failed to fetch characters.json");
      }
  
      const characters = await res.json();
  
      characters.forEach(char => {
        const card = document.createElement("div");
        card.className = "character-card";
  
        const title = document.createElement("h2");
        title.textContent = `${char.emoji} ${char.name}`;
        card.appendChild(title);
  
        const thoughtLabel = document.createElement("div");
        thoughtLabel.className = "section-label";
        thoughtLabel.textContent = char.id === 'director' ? 'Context' : 'Thought';
        card.appendChild(thoughtLabel);
  
        const thoughtContent = document.createElement("div");
        thoughtContent.className = "content";
        thoughtContent.id = `${char.id}-thought`;
        thoughtContent.textContent = "Loading...";
        card.appendChild(thoughtContent);
  
        fetchAndSet(`${char.id}-thought`, char.thoughtEndpoint, char.id === 'director' ? 'context' : 'thought');
  
        if (char.hasPerception) {
          const streamLabel = document.createElement("div");
          streamLabel.className = "section-label";
          streamLabel.textContent = "Perception";
          card.appendChild(streamLabel);
  
          const streamContent = document.createElement("div");
          streamContent.className = "content";
          streamContent.id = `${char.id}-stream`;
          streamContent.textContent = "Loading...";
          card.appendChild(streamContent);
  
          fetchAndSet(`${char.id}-stream`, char.streamEndpoint, 'stream');
        }
  
        container.appendChild(card);
      });
    } catch (err) {
      console.error("Failed to load character directory:", err);
      container.innerText = "Error loading character dashboard.";
    }
  }
  
  setInterval(buildDashboard, 60000); // Refresh every 60 sec
</script>
  